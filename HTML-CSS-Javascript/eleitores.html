<!-- 
    Titulo: Código simples para calcular a idade e saber se a pessoa precisa votar na eleição ou não
    Author: Breno D. Chrispim
    Descrição: Código simples que utiliza quatro funções JavaScript com o objetivo de mostrar ao usuario a idade que ele tem nos anos de eleição e se ele 
    precisa participar do processo eleitoral ou não. Isso se baseia na lei brasileiro onde pessoas com menos de 16 anos não podem votar, pessoas com idades 
    entre 16 anos e 18 anos tem o voto facultativo, pessoas com idades entre 18 e 65 precisam participar e aqueles com idade superior a 65 podem participar 
    ou não. Código visando fazer exercício do curso Padrão Web - HTML e CSS da pós-graduação Desenvolvimento Full Stack e Cloud Computing do Gran Faculdade.
-->
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Eleitores</title>
    <script>
        /* 
            Definições das funções em JavaScript. As funções utilizadas são:
            calcularIdade: Função que retorna a idade da pessoa (int)
            precisoParticipar: Função que retorna uma mensagem dizendo se a pessoa deve ir votar (str)
            tabelaAnoEleicoes: Modifica a tabela com id tabelaEleicoes para adicionar linhas no formato
                (ano de eleição, idade no ano de eleição, informação se precisa votar ou não) para cada ano considerado
            limparTabela: Limpa a tabela com id tabelaEleicoes
        */
        function calcularIdade(anoNascimento, mesNascimento, anoAtual, mesAtual) {
            /* 
                Descrição: Função que retorna a idade da pessoa.
                Entrada:
                    anoNascimento: Ano em que o usuario nasceu (int)
                    mesNascimento: Mes em que o usuario nasceu (int)
                    anoAtual: Ano atual (ou ano em que ocorreu a eleição) (int)
                    mesAtual: Mes atual (ou mes em que ocorreu a eleição) (int)
                Saida:
                    Idade da pessoa (int)
            */

            // Calcula a diferença entre o ano atual e o ano de nascimento
            let idade = anoAtual - anoNascimento;

            // Verifica se a pessoa já fez aniversário no ano
            if (mesAtual < mesNascimento) {
                idade--; // Subtrai 1 se a pessoa ainda não tiver feito aniversário no ano
            }
            
            // Retorna a idade da pessoa
            return idade;
        }
        
        function precisoParticipar(idadeNaEleicao) {
            /*      
                Descrição: Função que retorna uma mensagem dizendo se a pessoa deve ir votar (str)        
                Entradas
                    idadeNaEleicao: Idade que o usuario tinha/tem no ano considerado (int)
                Saida
                    Mensagem indicando se o usuario não pode/pode se quiser/precisa ir votar (string) 
            */

            // Condicionais usando a idade
            if (idadeNaEleicao < 16) {                                  // Menor de 16 anos, não vota
                var mensagem = 'Você não tem idade minima para votar'
            } else if (idadeNaEleicao >= 16 && idadeNaEleicao < 18) {   // Maior/igual de 16 e menor que 18, voto facultativo
                var mensagem = 'Você pode votar ou não.'
            } else if (idadeNaEleicao >=18 && idadeNaEleicao < 65) {    // Maior/igual de 18 e menor que 65, voto obrigatório
                var mensagem = 'Você precisa votar.'
            } else {                                                    // Maior/igual de 65, voto facultativo
                var mensagem = 'Você pode votar ou não.'
            }

            // Retorna a mensagem selecionada
            return mensagem
        }
        
        function tabelaAnoEleicoes(anoNascimento, mesNascimento){
            /*
                Descrição: Modifica a tabela com id tabelaEleicoes para adicionar linhas no formato
                    (ano de eleição, idade no ano de eleição, informação se precisa votar ou não)
                Entradas
                    anoNascimento: Ano em que o usuario nasceu (int)
                    mesNascimento: Mes em que o usuario nasceu (int)
                    tabelaEleicoesBrasil: Lista de anos de eleições no Brasil (int) entre 1989 e 2042 (list)
                Processamento
                    Essa função depende das funções calcularIdade e precisoParticipar
                Saída
                    Nenhuma
            */

            // Lista de anos de eleições no Brasil entre 1989 e 2042
            const tabelaEleicoesBrasil = [1989, 1994, 1998, 2002, 2006, 2010, 2014, 2018, 2022, 2026, 2030, 2034, 2038, 2042]
            
            // Iteração sob toda a lita tabelaEleicoesBrasil
            for (let i = 0; i < tabelaEleicoesBrasil.length; i++) {
                
                // Pega a referencia do corpo da tabela tabelaEleicoes
                var tableBody = document.getElementById("tabelaEleicoes").getElementsByTagName('tbody')[0];

                // Calcula a idade do usuario no ano de eleição
                var idadeNaEleicao = calcularIdade(anoNascimento, mesNascimento, tabelaEleicoesBrasil[i], 10)

                // Calcula a mensagem se o usuario precisa ou não participar da eleição
                var mensagemSobreParticipar = precisoParticipar(idadeNaEleicao)
                
                // Verifica a consistencia da idade do usuario
                if (idadeNaEleicao <= 0) {              // Verifica se o usuario era nascido na data da eleição
                    continue                            // Pula o caso
                } else if (idadeNaEleicao > 150) {      // Verifica se o usuario colocou uma data possivel
                                                        // (supondo que não existe pessoa com mais de 150 anos)
                    alert("Não é possivel.")
                    break                               // Sai do loop
                } else {
                    
                    // Cria uma nova linha na tabela
                    var newRow = tableBody.insertRow();

                    // Insera uma nova celula na nova linha
                    var cellYear = newRow.insertCell(0);
                    var cellAge = newRow.insertCell(1);
                    var cellParticipate = newRow.insertCell(2);

                    // Aloca os valores para as celulas
                    cellYear.innerHTML = tabelaEleicoesBrasil[i];           // Valor considerado dentro do loop
                    cellAge.innerHTML = idadeNaEleicao;                     // Idade calculada nesse ano
                    cellParticipate.innerHTML = mensagemSobreParticipar;    // Mensagem sobre a participação na eleição
                }
            }
        }
       
        function limparTabela(){
            /*
                Descrição: Modifica a tabela com id tabelaEleicoes para remover todas as linhas.
                Saida
                    Nenhuma
            */

            // Pega a referencia do corpo da tabela tabelaEleicoes
            var tableBody = document.getElementById("tabelaEleicoes").getElementsByTagName('tbody')[0];
            
            // Iteração sob toda a lita tabelaEleicoesBrasil removendo as linhas
            while (tableBody.firstChild) {
                tableBody.removeChild(tableBody.firstChild);
            }
        }

    </script>
</head>
<body>
    <h2>Você precisa ir votar?</h2>
    <p>Essa pagina calcula a sua idade nos anos de eleições entre 1989 e 2042.</p>
    <form action="">
        <!-- 
            Definição da pagina HTML com botões de input e output da função JavaScript.
        -->
        Ano de nascimento: <input type="number" id="ano"><br>
        <label for="mes">Mês de nascimento:</label>
        <select id="mes" name="mes">
            <option value="1">Janeiro</option>
            <option value="2">Fevereiro</option>
            <option value="3">Março</option>
            <option value="4">Abril</option>
            <option value="5">Maio</option>
            <option value="6">Junho</option>
            <option value="7">Julho</option>
            <option value="8">Agosto</option>
            <option value="9">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
        </select><br>
        <input type="button" value="Quando eu vou poder votar?" onclick="tabelaAnoEleicoes(document.getElementById('ano').value, document.getElementById('mes').value)">
        <input type="button" value="Limpar tabela" onclick="limparTabela()"><br>
    </form>
    <table id="tabelaEleicoes">
        <thead>
            <tr>
                <th>Ano de Eleição</th>
                <th>Idade nesse ano</th>
                <th>Preciso participar?</th>
            </tr>
        </thead>
        <tbody>
            <tbody>
                <!-- Rows will be dynamically added here using JavaScript -->
            </tbody>
        </tbody>
    </table>
</body>
</html>